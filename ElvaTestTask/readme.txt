Парочка комментариев по поводу алгоритма:
1) К сожалению моему смертному айпишнику не хватило облачной благодати, чтобы сервис решил ответить на мой запрос,
хотя составляется он на 100 процентов верно.

2) В связи с этим я не смог прогнать натурный тест, так что алгоритм работает чисто теоретически
(может у вас получится подтвердить или опровергнуть его верность).

3) Я знаю что конструкция типа "polygon_geojson=1" позволяет уменьшить число полигонов,
но в манулах не указывается поведение сервиса при изменении значения, так что пока без сжатия точек.

4) Несмотря на пункт "2", демонстратор возможного использования загрузчика и его хелпера отработал как надо
(ну за исключением самой загрузки, сервер всё равно слал меня куда не надо).

5) Я специально не оставлял обработчиков исключений, поскольку они обсолютно не нужны при такой конструкции приложения.